(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}})();class b{constructor(){this.initializeEventListeners()}initializeEventListeners(){const t=document.getElementById("convertBtn"),e=document.getElementById("copyBtn"),r=document.getElementById("htmlInput");t.addEventListener("click",()=>this.convertHTML()),e.addEventListener("click",()=>this.copyToClipboard());let o;r.addEventListener("input",()=>{clearTimeout(o),o=setTimeout(()=>this.convertHTML(),500)})}showStatus(t,e="success"){const r=document.getElementById("statusMessage");r.innerHTML=`<div class="status-message status-${e}">${t}</div>`,setTimeout(()=>{r.innerHTML=""},3e3)}convertHTML(){const t=document.getElementById("htmlInput").value.trim(),e=document.getElementById("mjmlOutput"),r=document.getElementById("copyBtn");if(!t){e.textContent="Your converted MJML code will appear here...",r.style.display="none";return}try{const o=this.htmlToMJML(t);e.textContent=o,r.style.display="block",this.showStatus("✅ Conversion successful! Styling preserved.","success")}catch(o){e.textContent=`Error: ${o.message}`,r.style.display="none",this.showStatus("❌ Conversion failed. Please check your HTML syntax.","error")}}htmlToMJML(t){const r=new DOMParser().parseFromString(t,"text/html"),o=this.extractStyles(r),n=r.body||r.documentElement,s=this.convertElement(n,o),i=`<mjml>
  <mj-head>
    <mj-title>Converted Email</mj-title>
    <mj-preview>Email converted from HTML</mj-preview>
    <mj-attributes>
      <mj-all font-family="Arial, sans-serif" />
      <mj-text padding="0" />
      <mj-section padding="0" />
      <mj-column padding="0" />
    </mj-attributes>
    ${o.cssStyles?`<mj-style>
      ${o.cssStyles}
      /* Ensure exact style preservation */
      * { box-sizing: border-box; }
      table { border-collapse: collapse; }
      .preserve-bg { background-color: inherit !important; }
    </mj-style>`:`<mj-style>
      /* Ensure exact style preservation */
      * { box-sizing: border-box; }
      table { border-collapse: collapse; }
      .preserve-bg { background-color: inherit !important; }
    </mj-style>`}
  </mj-head>
  <mj-body>
    ${s}
  </mj-body>
</mjml>`;return this.formatMJML(i)}extractStyles(t){let e="";const r={};return t.querySelectorAll("style").forEach(s=>{e+=s.textContent+`
`,this.parseCSS(s.textContent,r)}),t.querySelectorAll('link[rel="stylesheet"]').length>0&&(e+=`/* Note: External stylesheets detected but not imported */
`),{cssStyles:e.trim(),classStyles:r}}parseCSS(t,e){(t.match(/\.[^{]+\{[^}]*\}/g)||[]).forEach(o=>{const n=o.match(/\.([^{,\s]+)\s*\{([^}]*)\}/);if(n){const s=n[1],i=n[2],c={};i.split(";").forEach(h=>{const[d,u]=h.split(":").map(g=>g.trim());d&&u&&(c[d]=u)}),e[s]=c}})}mergeStyles(t,e){const r={};if(t.className&&t.className.split(" ").forEach(n=>{e[n]&&Object.assign(r,e[n])}),t.style){const o=this.parseInlineStyles(t.style.cssText);Object.assign(r,o)}return r}buildCSSText(t){return Object.entries(t).map(([e,r])=>`${e}: ${r}`).join("; ")}convertElement(t,e,r=0){if(!t||t.nodeType===Node.TEXT_NODE)return t?t.textContent.trim():"";const o=t.tagName?t.tagName.toLowerCase():"";if(t.style&&t.style.cssText,t.className,this.getElementAttributes(t),this.mergeStyles(t,e.classStyles||{}),r===0&&["html","head","body"].includes(o))return this.convertChildren(t,e,r);let n="";switch(o){case"div":case"section":n=this.convertContainer(t,e,r);break;case"table":n=this.convertTable(t,e,r);break;case"tr":n=this.convertTableRow(t,e,r);break;case"td":case"th":n=this.convertTableCell(t,e,r);break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":n=this.convertHeading(t,e,r);break;case"p":n=this.convertParagraph(t,e,r);break;case"a":n=this.convertLink(t,e,r);break;case"button":n=this.convertButton(t,e,r);break;case"img":n=this.convertImage(t,e,r);break;case"span":case"strong":case"b":case"em":case"i":n=this.convertInlineElement(t,e,r);break;case"br":return"<br/>";case"hr":n='<mj-divider border-width="1px" border-color="#cccccc" />';break;default:n=this.convertContainer(t,e,r);break}return n}convertContainer(t,e,r){const o=this.mergeStyles(t,e.classStyles||{}),n=this.convertChildren(t,e,r+1),s=this.hasBlockChildren(t);if(r===0||s){const i=this.buildStyleAttributes(o,"section"),c=this.buildStyleAttributes(o,"column");return`<mj-section ${i}>
      <mj-column ${c}>
        ${n}
      </mj-column>
    </mj-section>`}else{const i=this.buildStyleAttributes(o,"text"),c=this.buildCSSText(o);return`<mj-text ${i}>
      <div style="${c}">${n}</div>
    </mj-text>`}}convertTable(t,e,r){const o=this.mergeStyles(t,e.classStyles||{}),n=this.convertChildren(t,e,r+1);return`<mj-section ${this.buildStyleAttributes(o,"section")}>
      <mj-column>
        <mj-table ${this.buildStyleAttributes(o,"table")}>
          <table style="${this.buildCSSText(o)}">
            ${n}
          </table>
        </mj-table>
      </mj-column>
    </mj-section>`}convertTableRow(t,e,r){const o=this.convertChildren(t,e,r+1),n=this.mergeStyles(t,e.classStyles||{});return`<tr style="${this.buildCSSText(n)}">${o}</tr>`}convertTableCell(t,e,r){const o=this.convertChildren(t,e,r+1),n=this.mergeStyles(t,e.classStyles||{});return`<td style="${this.buildCSSText(n)}">${o}</td>`}convertHeading(t,e,r){const o=this.mergeStyles(t,e.classStyles||{}),n=this.convertChildren(t,e,r+1),s=this.getHeadingSize(t.tagName);return`<mj-text ${this.buildStyleAttributes(o,"text")} font-size="${s}">
      <${t.tagName.toLowerCase()} style="${this.buildCSSText(o)}">${n}</${t.tagName.toLowerCase()}>
    </mj-text>`}convertParagraph(t,e,r){const o=this.mergeStyles(t,e.classStyles||{}),n=this.convertChildren(t,e,r+1);return`<mj-text ${this.buildStyleAttributes(o,"text")}>
      <p style="${this.buildCSSText(o)}">${n}</p>
    </mj-text>`}convertLink(t,e,r){const o=t.getAttribute("href")||"#",n=this.convertChildren(t,e,r+1),s=this.mergeStyles(t,e.classStyles||{});return`<a href="${o}" style="${this.buildCSSText(s)}">${n}</a>`}convertButton(t,e,r){const o=this.mergeStyles(t,e.classStyles||{}),n=t.textContent||t.innerHTML,s=t.getAttribute("onclick")?"#":t.getAttribute("href")||"#";return`<mj-button ${this.buildStyleAttributes(o,"button")} href="${s}">
      ${n}
    </mj-button>`}convertImage(t,e,r){const o=t.getAttribute("src")||"",n=t.getAttribute("alt")||"",s=this.mergeStyles(t,e.classStyles||{});return`<mj-image ${this.buildStyleAttributes(s,"image")} src="${o}" alt="${n}" />`}convertInlineElement(t,e,r){const o=this.convertChildren(t,e,r+1),n=t.tagName.toLowerCase(),s=this.mergeStyles(t,e.classStyles||{});return`<${n} style="${this.buildCSSText(s)}">${o}</${n}>`}convertChildren(t,e,r){if(!t.childNodes)return"";let o="";for(let n of t.childNodes)if(n.nodeType===Node.TEXT_NODE){const s=n.textContent.trim();s&&(o+=s)}else n.nodeType===Node.ELEMENT_NODE&&(o+=this.convertElement(n,e,r));return o}parseInlineStyles(t){const e={};return t&&t.split(";").forEach(r=>{if(r.trim()){const[o,n]=r.split(":").map(s=>s.trim());o&&n&&(e[o]=n)}}),e}buildStyleAttributes(t,e){const r=[],n={section:{"background-color":"background-color",background:"background-color","background-image":"background-url","background-repeat":"background-repeat","background-size":"background-size",padding:"padding","padding-top":"padding-top","padding-bottom":"padding-bottom","padding-left":"padding-left","padding-right":"padding-right",margin:"padding","text-align":"text-align",border:"border","border-radius":"border-radius"},column:{"background-color":"background-color",background:"background-color",padding:"padding","padding-top":"padding-top","padding-bottom":"padding-bottom","padding-left":"padding-left","padding-right":"padding-right",border:"border","border-radius":"border-radius"},text:{color:"color","font-family":"font-family","font-size":"font-size","font-weight":"font-weight","text-align":"align","line-height":"line-height",padding:"padding","padding-top":"padding-top","padding-bottom":"padding-bottom","padding-left":"padding-left","padding-right":"padding-right","background-color":"background-color",background:"background-color"},button:{"background-color":"background-color",background:"background-color",color:"color","font-family":"font-family","font-size":"font-size","font-weight":"font-weight",padding:"inner-padding","border-radius":"border-radius",border:"border","text-align":"align",width:"width",height:"height"},image:{width:"width",height:"height",padding:"padding",border:"border","border-radius":"border-radius"},table:{width:"width","background-color":"background-color",background:"background-color",border:"border","border-collapse":"border",padding:"padding"}}[e]||{};return Object.entries(t).forEach(([s,i])=>{if(s==="background"&&i){const c=this.extractBackgroundColor(i);c&&r.push(`background-color="${c}"`)}else{const c=n[s];c&&i&&r.push(`${c}="${i}"`)}}),r.join(" ")}extractBackgroundColor(t){const e=/(#[0-9a-fA-F]{3,6}|rgb\([^)]+\)|rgba\([^)]+\)|[a-zA-Z]+)/,r=t.match(e);return r?r[0]:null}hasBlockChildren(t){const e=["div","p","h1","h2","h3","h4","h5","h6","table","section","article"];for(let r of t.children||[])if(e.includes(r.tagName.toLowerCase()))return!0;return!1}getHeadingSize(t){return{H1:"32px",H2:"24px",H3:"20px",H4:"18px",H5:"16px",H6:"14px"}[t.toUpperCase()]||"16px"}getElementAttributes(t){const e={};if(t.attributes)for(let r of t.attributes)e[r.name]=r.value;return e}formatMJML(t){let e=t,r=0;const o=e.split(`
`),n=[];return o.forEach(s=>{const i=s.trim();i&&(i.startsWith("</")&&(r=Math.max(0,r-2)),n.push(" ".repeat(r)+i),i.startsWith("<")&&!i.startsWith("</")&&!i.endsWith("/>")&&(r+=2))}),n.join(`
`)}async copyToClipboard(){const e=document.getElementById("mjmlOutput").textContent;try{await navigator.clipboard.writeText(e),this.showStatus("📋 MJML code copied to clipboard!","success")}catch{const o=document.createElement("textarea");o.value=e,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),this.showStatus("📋 MJML code copied to clipboard!","success")}}}window.loadExample=function(a){const t=a.innerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");document.getElementById("htmlInput").value=t,l.convertHTML()};const l=new b;document.addEventListener("keydown",a=>{(a.ctrlKey||a.metaKey)&&a.key==="Enter"&&l.convertHTML(),(a.ctrlKey||a.metaKey)&&a.key==="c"&&a.target.id==="mjmlOutput"&&l.copyToClipboard()});console.log("HTML to MJML Converter initialized!");
